{
  "llm_model_name": "Qwen/Qwen3-8B",
  "vision_model_name": "google/siglip2-base-patch16-224",
  "tokenizer_name": "Qwen/Qwen3-8B",
  "max_text_length": 4096,
  "projector": {
    "num_queries": 32,
    "num_layers": 4,
    "num_heads": 16,
    "num_experts": 8,
    "hidden_size": 4096,
    "ec_routing": false
  },
  "text_moe": {
    "num_experts": 16,
    "router_top_k": 2,
    "expert_intermediate_mult": 4,
    "moe_layers": [
      12,
      13,
      14,
      15,
      24,
      25,
      26,
      27,
      32,
      33,
      34,
      35
    ],
    "ep_size": 8,
    "use_shared_expert": true,
    "shared_expert_scale": 0.1,
    "use_expert_choice_router": false
  },
  "vision_moe": {
    "num_experts": 8,
    "router_top_k": 2,
    "back_k_layers": 4,
    "ep_size": 8,
    "use_mid_tokens": true,
    "mid_layer_index": -4,
    "use_shared_expert": true,
    "shared_expert_scale": 0.1,
    "use_expert_choice_router": false
  },
  "router": {
    "noisy_gate_policy": "Jitter",
    "capacity_factor": 1.25,
    "min_capacity": 4,
    "aux_loss_coef": 0.01,
    "aux_loss_coefs": {"text_moe": 0.02, "vision_moe": 0.03, "projector_moe": 0.05},
    "token_drop": false,
    "global_balance_coef": {"text_moe": 0.002, "vision_moe": 0.003},
    "use_megablocks_dropless": false
  },
  "alignment": {
    "image_token": "<image>",
    "image_token_dropout": 0.0,
    "segment_size_text": 64,
    "segment_size_image": 32
  },
  "precision": {
    "bf16": true,
    "fp16": false,
    "flash_attention_impl": "flash_attention_3"
  }
}
